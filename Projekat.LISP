(defun Game(n)
  (GamePlay n 1 (* n 2) (* n 2) (initMatrix 0 n))
)

(defun GamePlay(n p xN oN li)
  (ShowMatrix2 n li)
)
(defun initMatrix(i n)
  (cond ((= i n) '())
        ((< i 2) (cons (append (list i) (list (initRow 0 n 1))) (initMatrix (+ i 1) n)))
        ((> i (- n 3)) (cons (append (list i) (list (initRow 0 n 2))) (initMatrix (+ i 1) n)))
        ('t (cons (append (list i) (list (initRow 0 n 0))) (initMatrix (+ i 1) n)))
))

(defun initRow(j n el)
  (cond ((= j n) '())
        ('t (cons (list j el) (initRow (+ j 1) n el)))
))

(defun ShowMatrix(i li n)
  (cond ((= i n) '())
        ('t (print i )(ShowRow 0 (car (cdr (assoc i li))) n) (ShowMatrix (+ i 1) li n))
))

(defun ShowRow(j li n)
  (cond ((= j n) '())
        ('t (format t "~D~%" (car (cdr (assoc j li)))) (ShowRow (+ j 1) li n))
        ('t (write "(car (cdr (assoc j li))) -" ) (ShowRow (+ j 1) li n))
))

(defun ShowMatrix2(n li)
(dotimes( g (+ 1 n))
            (cond ((= g 0) (format t "  "))
                  ('t (format t " ~d " (- g 1)))
)
)
  (dotimes(i n)
    (print i)
    (dotimes(j n)
      (format t "|~a|" (RetLetter(car (cdr (assoc j (car (cdr (assoc i li))))))))
)
)
)

(defun RetLetter(el)
  (cond ((= el 0) "-")
        ((= el 1) "X")
        ('t "O"))
)